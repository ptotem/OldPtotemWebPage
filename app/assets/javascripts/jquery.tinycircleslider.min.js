(function(a){function b(b,c){function I(a,d){t=Math.round(a*q/360);t=t===q?0:t;j[0].style.left=-(a/360*n*q)+"px";g.style.top=Math.round(-Math.cos(B(a))*c.radius+(f/2-i/2))+"px";g.style.left=Math.round(Math.sin(B(a))*c.radius+(e/2-h/2))+"px";if(typeof c.callback=="function"&&d){c.callback.call(b,k[t],t)}}function H(a){var b={left:a.pageX-d.offset().left-e/2,top:a.pageY-d.offset().top-f/2};r=F(C(Math.atan2(b.left,-b.top)));I(r);return false}function G(a,b,c,d){s++;var e=F(Math.round(s*a+r));if(s===c&&d){u.startInterval()}I(e,s===c);if(s<c){o=setTimeout(function(){G(a,b,c,d)},50)}else{s=0;r=b}}function F(a){return a+(a>360?-360:a<0?360:0)}function E(){var a=Math.round(r/(360/q));u.gotoSlide(a)}function D(){var b=a(".dot",d),g=b.outerWidth(),h=b.outerHeight();b.remove();var i=document.createDocumentFragment(),j=undefined,k=0,m={left:0,top:0},n=B(360/q);for(var o=q;o--;){k=o+1;dotClone=b.clone();m.top=Math.round(-Math.cos(o*n)*c.radius+(f/2-h/2));m.left=Math.round(Math.sin(o*n)*c.radius+(e/2-g/2));dotClone.addClass("dot-"+k);dotClone.css(m);dotClone.html("<span>"+k+"</span>");i.appendChild(dotClone[0])}d.append(i);l=a(".dot",d)}function C(a){return a*180/Math.PI}function B(a){return a*(Math.PI/180)}function A(a){p=setTimeout(function(){u.gotoSlide(Math.ceil(q*Math.random()),true)},a?50:c.intervaltime)}function z(){j.append(a(k[0]).clone());k=j.children()}function y(b){a(document).unbind("mousemove");document.onmouseup=g.onmouseup=null;clearTimeout(o);if(c.snaptodots){if(c.hidedots){l.stop(true,true).fadeOut("slow")}E()}u.startInterval();return false}function x(b){clearTimeout(p);a(document).mousemove(H);document.onmouseup=g.onmouseup=y;if(c.snaptodots&&c.hidedots){l.stop(true,true).fadeIn("slow")}return false}function w(){g.onmousedown=x;d.bind("touchstart",function(){clearTimeout(p);a(this).data("pan",{startX:event.targetTouches[0].screenX,lastX:event.targetTouches[0].screenX,startTime:(new Date).getTime(),distance:function(){return Math.round(this.startX-this.lastX)},delta:function(){var a=event.targetTouches[0].screenX,b=Math.round(this.lastX-a);this.lastX=a;return b},duration:function(){return(new Date).getTime()-this.startTime}});return false});d.bind("touchmove",function(){var b=a(this).data("pan");r=F(r+Math.round(b.delta()*2*360/(n*q)));I(r);return false});d.bind("touchend",function(){var b=a(this).data("pan");if(b.distance()===0&&b.duration()<500){d.trigger("click")}u.startInterval();return false});if(m.length>0){d.css({cursor:"pointer"}).click(function(b){if(a(b.target).hasClass("overlay")){if(c.lightbox){a(m[t]).trigger("click")}else{location.href=m[t].href}}return false})}if(c.snaptodots){d.delegate(".dot","click",function(){clearTimeout(p);if(0===s){u.gotoSlide(a(this).text()-1)}u.startInterval()})}}function v(){z();j[0].style.width=n*k.length+"px";if(c.snaptodots){D()}w();u.gotoSlide(0);u.startInterval(true)}var d=b;var e=d.outerWidth();var f=d.outerHeight();var g=a(".thumb",d)[0];var h=a(g).outerWidth();var i=a(g).outerHeight();var j=a(".overview",d);var k=j.children();var l={};var m=a("a",k);var n=a(k[0]).outerWidth(true);var o,p;var q=k.length,r=10,s=0,t=0;var u=this;this.startInterval=function(a){if(c.interval){A(a)}};this.stopInterval=function(){clearTimeout(p)};this.gotoSlide=function(a,b){var c=a*(360/q),d=0,e=0;if(c>r){d=c-r;e=-(r+(360-c))}if(c<r){d=c+(360-r);e=-(r-c)}var f=d<Math.abs(e)?d:e,g=Math.ceil(Math.abs(f)/10),h=f/g||0;G(h,c,g,b)};v()}a.tiny=a.tiny||{};a.tiny.circleslider={interval:false,intervaltime:3500,snaptodots:false,hidedots:true,radius:140,lightbox:false,callback:null};a.fn.tinycircleslider=function(c){var c=a.extend({},a.tiny.circleslider,c);this.each(function(){a(this).data("tcs",new b(a(this),c))});return a.extend(this,{gotoSlide:function(b,c){return this.each(function(){a(this).data("tcs").gotoSlide(b,c)})},stopInterval:function(){return this.each(function(){a(this).data("tcs").stopInterval()})},startInterval:function(){return this.each(function(){a(this).data("tcs").startInterval()})}})};})(jQuery)